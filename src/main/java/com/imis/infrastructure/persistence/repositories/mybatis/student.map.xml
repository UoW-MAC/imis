<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.imis.domain.repositories.StudentRepository">
	<cache eviction="FIFO" flushInterval="60000" size="512" readOnly="true" />
    
    <resultMap type="Student" id="studentResultMap">
        <result property="studentId" column="student_id" />
        <result property="studentNo" column="student_no" />
        <result property="firstName" column="first_name" />
        <result property="middleName" column="middle_name" />
        <result property="lastName" column="last_name" />
        <result property="email" column="email" />
        <result property="telephone" column="telephone" />
        <result property="status" column="status" />
        <result property="gender" column="gender" />
        <result property="semsterRegistered" column="semester_registered" /> 
        <result property="registeredYear" column="registered_year" />
    </resultMap>
     
    <insert id="addStudentInfo" useGeneratedKeys="false" parameterType="Student" >
	    <selectKey keyProperty="studentId" resultType="long" order="BEFORE">  
	    	select SEQ_STUDENT.NEXTVAL from dual  
	    </selectKey>  
    	<![CDATA[
	    	insert into student(student_id,student_no,first_name,middle_name,last_name,email,telephone,status,gender,semester_registered,registered_year,user_id,create_time,update_time)
	    	values(#{studentId},#{studentNo},#{firstName},#{middleName},#{lastName},#{email},#{telephone},#{status},#{gender},'2015','2015',123,#{createTime},#{updateTime})
    	]]>
    </insert>  
    <update id="updateStudentInfo" parameterType="Student" >
          UPDATE STUDENT
                SET STUDENT.STUDENT_NO = #{studentNo},
                    STUDENT.FIRST_NAME = #{firstName},
                    STUDENT.MIDDLE_NAME = #{middleName},
                    STUDENT.LAST_NAME = #{lastName},
                    STUDENT.EMAIL = #{email},
                    STUDENT.TELEPHONE = #{telephone},
                    STUDENT.STATUS = #{status},
                    STUDENT.GENDER = #{gender},
                    STUDENT.SEMESTER_REGISTERED = #{semesterRegistered},
                    STUDENT.REGISTERED_YEAR = #{registeredYear}
              WHERE STUDENT.STUDENT_ID = #{studentId}     
                    
    </update>
    <select id="getStudentInfo" parameterType="String" resultMap="studentResultMap">
             SELECT ST.STUDENT_ID,
                    ST.STUDENT_NO,
                    ST.FIRST_NAME,
                    ST.MIDDLE_NAME,
                    ST.LAST_NAME,
                    ST.EMAIL,
                    ST.TELEPHONE,
                    ST.STATUS,
                    ST.GENDER,
                    ST.SEMESTER_REGISTERED,
                    ST.REGISTERED_YEAR
              FROM STUDENT ST
              WHERE ST.STUDENT_ID = #{studentId}
    </select>
</mapper>

